# -*- coding: utf-8 -*-
"""Bab 2 (Data manipulation).ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1_G1_zjXLkJNmFrYoWu11YMOpf1uepxhD
"""

### Untuk memulai platform PYTORCH, kita dapat memanggil modul torch ###
### Sebuah tensor merepresentasikan sebuah (multi dimensi) susunan dengan nilai-nilai numerik di dalamnya ####
### Sebuah susunan nilai-nilai numerik dengan satu sumbu atas sebuah tensor dapat disebut sebagai sebuah vektor ###
### Sebuah tensor yang memiliki dua sumbu disebut sebagai sebuah matriks ###
### Sebuah tensor yang memiliki sejumlah sumbu katakanlah k sumbu, maka dapat disebut sebagai tensor dengan orde-k ###
import torch

### Untuk membuat sebuah vektor dalam platform PYTORCH, kita dapat membuat susunan nilai-nilai numerik di dalanya yang dimulai dari 0 sampai dengan n###
x = torch.arange(12, dtype=torch.float32)
print (x)

### Kita dapat mengecek ukuran sebuah tensor (panjang data atas tiap sumbu) dengan melakukan inspeksi properti bentuk (shape) sebuah tensor ###
x.shape

### Jika kita ingin mengetahui jumlah elemn di dalam sebuah tensor, yaitu hasil perkalian dari ukuran elemen-elemen didalamnya dengan perintah sebagai berikut ###
x.numel()

### Untuk merubah bentuk dari sebuah tersor tanpa mengubah jumlah elemen-elemennya atau nilai-nilainya, kita dapat menggunakan modul berikut ini ####
X = x.reshape(3, 4)
print(X)

### Selanjutnya jika kita ingin menginisialisasikan matriks X di atas dengan mengganti input nilai numeriknya dengan nol, satu ataupun suatu konstanta, kita dapat menggunakan modul berikut ini ###
torch.zeros((2, 3, 4))

torch.ones((2, 3, 4))

### Seringkali, kita ingin menginput nilai -nilai numerik secara random atas elemen-elemen di dalam sebuah tensor dengan distribusi probabilitas tertentu ###
### Sebagai contoh, kita akan mengisi setiap elemen secara random terdistribusi normal ( mean = 0, dan sd =1) dalam tensor dengan ukuran 3  untuk keempat vektor di bawah ini###
torch.randn(3, 4)

### Kita juga dapat membuat setiap elemen dalam tensor dalam bentuk tensor juga, yang ditunjukkan sbagai berikut ###
torch.tensor([[2,1,4,3],[1,2,3,4],[4,3,2,1]])

### Berikutnya juga terdapat operasi diantaranya ada operasi unary scalar dan binary scalar serta juga disertai operator aritmatika untuk melakukan operasi terhadap elemen-elemen didalamnya###
x = torch.tensor([1.0, 2, 4, 8])
y = torch.tensor([2, 2, 2, 2])
x + y, x - y, x * y, x / y, x ** y

### Eksponensiasi juga dapat dimasukkan ke dalam kelompok operator unary ketika kita melakukan proses perkalian element-wise yaitu perkalian yang didapatkan dari penjumlahan antar elemen baris dengan elemen kolom yang bersesuaian ###
torch.exp(x)

### Perkalian element-wise yang melibatkan perkalian dot produk ataupun perkalian matrisks juga dapat dibuat secara concatenate yaitu mengabungkan elemen-elemen setelah dilakukan proses perkalian menjadi sebuah matriks baru tentunya dapat ditunjukkan sebagai berikut ###
X = torch.arange(12, dtype=torch.float32).reshape((3,4))
Y = torch.tensor([[2.0, 1, 4, 3], [1, 2, 3, 4], [4, 3, 2, 1]])
torch.cat((X, Y), dim=0), torch.cat((X, Y), dim=1)

### Dalam kondisi tertentu, kita dapat menyusun susunan angka di dalam sebuah tensor ke dalam satu kolom atau satu baris ###
a = torch.arange(3).reshape((3, 1))
b = torch.arange(2).reshape((1, 2))
a, b

### karena dimensi tensor a dan b berbeda, maka bentuk mereka tidak akan dapat dibuat penjumlahannya, namun dalam operator penjumlahan di torch, program akan mengasumsikan kedua matriks tersebut dapat disesuaikan dimensinya dengan mereplikasikan kolom dan barisnya sehingga dapat dijumlahkan ###
a + b

### Dalam susunan array yang dikenal oleh bahasa program Python, kita dapat mengakses sebuah matriks atau tensor dengan menyebutkan komponen yang akan dipilih ###
### X[-1] mengartikan kita memilih elemen-elemen terakhir dalam sebuah matriks ###
### X[1:3] mengartikan kita memilih elemen-elemen kedua dan ketiga ###
X[-1], X[1:3]

### Sebelum program membaca datam kita dapat menuliskan data dalam matriksnya sesuai dengan indeks yang diberikan ###
X[1, 2] = 9
X

### Dalam menjalankan operator terhadap data yang disimpan dalam memory, maka pada umumnya hasi operasi tersebut akan dialokasikan ke dalam memory yang baru ###
### Dalam pengecekan apakah hasil operator tersebut akan dialokasikan ke memory yang baru atau tidak, kita dapat mengeceknya dengan modul berikut ###
before = id(Y)
Y = Y + X
id(Y) == before

### Pengecekan tersebut sangat bermanfaat apabila kita mengaplikasikan pembelajaran mesin yang mungkin membutuhkan ratusan megabyte untuk mengenal parameter dan melakukan update dengan perkalian untuk setiap detiknya ###
### Sebagai ilustrasi, kita akan membuat sebuah matriks baru Z yang memiliki bentuk yang sama dengan matriks Y, dengan menggunakan zeros_like untuk mengalokasikan blok dengan entri 0 di dalamnya ####
Z = torch.zeros_like(Y)
print('id(Z):', id(Z))
Z[:] = X + Y
print('id(Z):', id(Z))

### Mengkonversi objek yang ada dalam python (Torch) yang dapat berupa tensor dalam torch atau array dalam numpy sehingga dapat memaksimalkan performa manipulasi data dengan baik ###
A = X.numpy()
B = torch.from_numpy(A)
type(A), type(B)

### Untuk mengubah sebuah tensor dengan ukuran 1 kedalam skalar, kita dapat menggunakan fungsi sebagai berikut ###
a = torch.tensor([3.5])
a, a.item(), float(a), int(a)
